version: "{branch}-ci-{build}"
os:
- Visual Studio 2013

platform:
- Win32

configuration:
- Debug 
#- Release

on_finish:
- ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

environment:
  BOOST_ROOT: C:\Libraries\boost_1_58_0
  BOOST_INCLUDEDIR: C:\Libraries\boost_1_58_0\boost
  BOOST_LIBRARYDIR: C:\Libraries\boost_1_58_0\lib32-msvc-12.0

install:
- git submodule init
- git submodule update
#- ruby --version
- gem update --system --no-ri --no-rdoc -q
- gem install bundler --no-document
- bundle install

build_script:
- cmake -E make_directory build
- cmake -E chdir build cmake -DAPPVEYOR=on -DVERBOSE=on -DCUKE_ENABLE_EXAMPLES=on -DCUKE_DISABLE_BOOST_TEST=on  -DCMAKE_BUILD_TYPE=Debug -DBOOST_ROOT="%BOOST_ROOT%" -DBOOST_INCLUDEDIR="%BOOST_INCLUDEDIR%" -DBOOST_LIBRARYDIR="%BOOST_LIBRARYDIR%" ..
#-DCUKE_DISABLE_FUNCTIONAL=on
- cmake --build build

test_script:
- cmake --build build --target RUN_TESTS
- cmake --build build --target features

notifications:
- provider: Email
  to:
    - konserw@gmail.com
  subject: cucumber_cpp AppVeyor Build
  on_build_success: false
  on_build_failure: true
  on_build_status_changed: true
